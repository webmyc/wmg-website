---
// InnerCouncil component with team member portraits and bios
import { Image } from 'astro:assets';

// Image position mapping for optimal face visibility
const positions = {
  jesse: '50% 35%',
  matthew: '50% 30%', 
  william: '50% 40%',
  yungen: '50% 40%',
};

const councilMembers = [
  {
    name: "Matthew",
    image: "/team/matthew.jpg",
    bio: "Mentor and facilitator devoted to men's inner work and service to community.",
    website: "#",
    instagram: "#"
  },
  {
    name: "Jesse", 
    image: "/team/jesse.jpg",
    bio: "Guide in embodiment and relational practice, weaving modern insight with perennial wisdom.",
    website: "#",
    instagram: "#"
  },
  {
    name: "William",
    image: "/team/william.jpg", 
    bio: "Practitioner of contemplative arts, supporting men to live with clarity, courage and compassion.",
    website: "#",
    instagram: "#"
  },
  {
    name: "Yungen",
    image: "/team/yungen.jpg",
    bio: "Space-holder and circle convener, honoring the noble code through practical daily action.", 
    website: "#",
    instagram: "#"
  }
];
---

<section aria-labelledby="council" class="relative py-20 px-6 bg-wmg-bg overflow-hidden">
  <!-- Organic background shading -->
  <div class="absolute inset-0 bg-gradient-to-br from-wmg-bg via-wmg-bg/95 to-wmg-bg/90"></div>
  <div class="absolute top-0 right-1/3 w-80 h-80 bg-wmg-gold/4 rounded-full blur-3xl animate-float"></div>
  <div class="absolute bottom-0 left-1/3 w-96 h-96 bg-wmg-gold/3 rounded-full blur-3xl animate-float-delayed"></div>
  
  <div class="relative max-w-6xl mx-auto">
    <h2 id="council" class="text-3xl md:text-4xl lg:text-5xl font-bold text-wmg-text mb-16 text-center section-title">
      The WMG Inner Council
    </h2>
    
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8">
      {councilMembers.map((member, index) => (
        <div class={`council-member council-member-${index + 1} text-center`}>
          <div class="relative mb-6">
            <img
              src={member.image}
              alt={`${member.name} - WMG Inner Council`}
              class="w-full aspect-square object-cover rounded-lg mx-auto"
              style={`object-position: ${positions[member.name.toLowerCase() as keyof typeof positions]}; max-width: 280px;`}
              loading="lazy"
            />
          </div>
          
          <h3 class="text-xl font-semibold text-wmg-text mb-3">
            {member.name}
          </h3>
          
          <p class="text-wmg-text/80 mb-4 leading-relaxed">
            {member.bio}
          </p>
          
          <div class="flex justify-center space-x-4">
            <a 
              href={member.website}
              class="text-wmg-gold hover:text-wmg-gold/80 transition-colors council-website-link"
              data-member={member.name}
              aria-label={`Visit ${member.name}'s website`}
            >
              <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 00-1.414 1.414 4 4 0 005.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 00-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd" />
              </svg>
            </a>
            <a 
              href={member.instagram}
              class="text-wmg-gold hover:text-wmg-gold/80 transition-colors council-instagram-link"
              data-member={member.name}
              aria-label={`Follow ${member.name} on Instagram`}
            >
              <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                <path d="M12.017 0C5.396 0 .029 5.367.029 11.987c0 6.62 5.367 11.987 11.988 11.987s11.987-5.367 11.987-11.987C24.014 5.367 18.637.001 12.017.001zM8.449 16.988c-1.297 0-2.448-.49-3.323-1.297C4.198 14.895 3.708 13.744 3.708 12.447s.49-2.448 1.418-3.323c.875-.807 2.026-1.297 3.323-1.297s2.448.49 3.323 1.297c.928.875 1.418 2.026 1.418 3.323s-.49 2.448-1.418 3.244c-.875.807-2.026 1.297-3.323 1.297zm7.83-9.281H8.721v9.281h7.558V7.707z"/>
              </svg>
            </a>
          </div>
        </div>
      ))}
    </div>
  </div>
</section>

<style>
  /* Organic floating animations */
  @keyframes float {
    0%, 100% {
      transform: translateY(0px) translateX(0px) scale(1);
    }
    33% {
      transform: translateY(-20px) translateX(10px) scale(1.05);
    }
    66% {
      transform: translateY(10px) translateX(-5px) scale(0.95);
    }
  }
  
  @keyframes floatDelayed {
    0%, 100% {
      transform: translateY(0px) translateX(0px) scale(1);
    }
    33% {
      transform: translateY(15px) translateX(-10px) scale(0.95);
    }
    66% {
      transform: translateY(-10px) translateX(5px) scale(1.05);
    }
  }
  
  .animate-float {
    animation: float 8s ease-in-out infinite;
  }
  
  .animate-float-delayed {
    animation: floatDelayed 10s ease-in-out infinite 2s;
  }
  
  /* Section animations */
  .section-title {
    opacity: 0;
    transform: translateY(30px) scale(0.95);
    animation: sectionTitleReveal 1s ease-out 0.2s forwards;
  }
  
  .council-member {
    opacity: 0;
    transform: translateY(40px) scale(0.9);
    transition: all 0.6s ease-out;
  }
  
  .council-member-1 {
    animation: councilMemberReveal 0.8s ease-out 0.5s forwards;
  }
  
  .council-member-2 {
    animation: councilMemberReveal 0.8s ease-out 0.7s forwards;
  }
  
  .council-member-3 {
    animation: councilMemberReveal 0.8s ease-out 0.9s forwards;
  }
  
  .council-member-4 {
    animation: councilMemberReveal 0.8s ease-out 1.1s forwards;
  }
  
  @keyframes sectionTitleReveal {
    to {
      opacity: 1;
      transform: translateY(0) scale(1);
    }
  }
  
  @keyframes councilMemberReveal {
    to {
      opacity: 1;
      transform: translateY(0) scale(1);
    }
  }
  
  /* Respect reduced motion */
  @media (prefers-reduced-motion: reduce) {
    .animate-float,
    .animate-float-delayed {
      animation: none;
    }
    
    .section-title,
    .council-member {
      animation: none;
      opacity: 1;
      transform: none;
    }
  }
</style>

<script>
  import { trackCouncilInteraction, trackLinkClick } from '../lib/analytics.ts';
  
  document.addEventListener('DOMContentLoaded', function() {
    // Track council member interactions
    const councilMembers = document.querySelectorAll('.council-member');
    councilMembers.forEach((member, index) => {
      // Track when council member comes into view
      const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
          if (entry.isIntersecting) {
            const memberName = member.querySelector('h3')?.textContent || `Member ${index + 1}`;
            trackCouncilInteraction(memberName, 'view');
            observer.disconnect(); // Only track once
          }
        });
      }, { threshold: 0.5 });
      
      observer.observe(member);
    });
    
    // Track website link clicks
    const websiteLinks = document.querySelectorAll('.council-website-link');
    websiteLinks.forEach(link => {
      link.addEventListener('click', (e) => {
        const memberName = link.getAttribute('data-member');
        if (memberName) {
          trackCouncilInteraction(memberName, 'website_click');
          trackLinkClick(`${memberName} Website`, link.getAttribute('href') || '', 'council');
        }
      });
    });
    
    // Track Instagram link clicks
    const instagramLinks = document.querySelectorAll('.council-instagram-link');
    instagramLinks.forEach(link => {
      link.addEventListener('click', (e) => {
        const memberName = link.getAttribute('data-member');
        if (memberName) {
          trackCouncilInteraction(memberName, 'instagram_click');
          trackLinkClick(`${memberName} Instagram`, link.getAttribute('href') || '', 'council');
        }
      });
    });
  });
</script>
